# ツール・コマンド

## ヘルプ系

### go
goコマンドのみを実行するとヘルプメッセージを確認できる。

### go help
コマンドのドキュメント参照
```bash
go help version

usage: go version [-m] [-v] [file ...]

Version prints the build information for Go binary files.

Go version reports the Go version used to build each of the named files.

If no files are named on the command line, go version prints its own
version information.

If a directory is named, go version walks that directory, recursively,
looking for recognized Go binaries and reporting their versions.
By default, go version does not report unrecognized files found
during a directory scan. The -v flag causes it to report unrecognized files.

The -m flag causes go version to print each file's embedded
module version information, when available. In the output, the module
information consists of multiple lines following the version line, each
indented by a leading tab character.

See also: go doc runtime/debug.BuildInfo.
```

### go version
バージョンの確認コマンド
```bash
go version
go version go1.20.6 linux/amd64
```

### go env
環境変数の確認
```bash
go env
GO111MODULE=""
GOARCH="amd64"
GOBIN=""
GOCACHE="/home/yk-you0922/.cache/go-build"
GOENV="/home/yk-you0922/.config/go/env"
GOEXE=""
GOEXPERIMENT=""
GOFLAGS=""
GOHOSTARCH="amd64"
GOHOSTOS="linux"
GOINSECURE=""
GOMODCACHE="/home/yk-you0922/go/pkg/mod"
GONOPROXY=""
GONOSUMDB=""
GOOS="linux"
GOPATH="/home/yk-you0922/go"
GOPRIVATE=""
GOPROXY="https://proxy.golang.org,direct"
GOROOT="/usr/local/go"
GOSUMDB="sum.golang.org"
GOTMPDIR=""
GOTOOLDIR="/usr/local/go/pkg/tool/linux_amd64"
GOVCS=""
GOVERSION="go1.20.6"
GCCGO="gccgo"
GOAMD64="v1"
AR="ar"
CC="gcc"
CXX="g++"
CGO_ENABLED="0"
GOMOD="/home/yk-you0922/go/src/sample-go-lang/udemy/src/test/go.mod"
GOWORK=""
CGO_CFLAGS="-O2 -g"
CGO_CPPFLAGS=""
CGO_CXXFLAGS="-O2 -g"
CGO_FFLAGS="-O2 -g"
CGO_LDFLAGS="-O2 -g"
PKG_CONFIG="pkg-config"
GOGCCFLAGS="-fPIC -m64 -fno-caret-diagnostics -Qunused-arguments -Wl,--no-gc-sections -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build2390212270=/tmp/go-build -gno-record-gcc-switches"
```

### go fmt
ソースコードを推奨される形式へ自動的に変換するコマンド  
インデントの乱れなどを成型する。

オプション
- -n
  - 実行されるコマンドの表示（ファイルは書き換えない）
  - 対象のファイルを確認するときに使う。
- -x
  - 実行されるコマンドの表示

### go doc <パッケージ名>
パッケージのドキュメントを参照する。

```bash
go doc math/rand

package rand // import "math/rand"

Package rand implements pseudo-random number generators unsuitable for
security-sensitive work.

Random numbers are generated by a Source, usually wrapped in a Rand. Both
types should be used by a single goroutine at a time: sharing among multiple
goroutines requires some kind of synchronization.

Top-level functions, such as Float64 and Int, are safe for concurrent use by
multiple goroutines.

This package's outputs might be easily predictable regardless of how it's
seeded. For random numbers suitable for security-sensitive work, see the
crypto/rand package.

func ExpFloat64() float64
func Float32() float32
func Float64() float64
func Int() int
func Int31() int32
func Int31n(n int32) int32
func Int63() int64
func Int63n(n int64) int64
func Intn(n int) int
func NormFloat64() float64
func Perm(n int) []int
func Read(p []byte) (n int, err error)
func Seed(seed int64)
func Shuffle(n int, swap func(i, j int))
func Uint32() uint32
func Uint64() uint64
type Rand struct{ ... }
    func New(src Source) *Rand
type Source interface{ ... }
    func NewSource(seed int64) Source
type Source64 interface{ ... }
type Zipf struct{ ... }
```

### go doc <パッケージ名>.<識別子>
```bash
go doc math/rand.Intn

package rand // import "math/rand"

func Intn(n int) int
    Intn returns, as an int, a non-negative pseudo-random number in the
    half-open interval [0,n) from the default Source. It panics if n <= 0.
```

### go doc <パッケージ名>.<識別子>.<メソッド名>
```bash
go doc time.Time.Unix

package time // import "time"

func (t Time) Unix() int64
    Unix returns t as a Unix time, the number of seconds elapsed since January
    1, 1970 UTC. The result does not depend on the location associated with t.
    Unix-like operating systems often record time as a 32-bit count of seconds,
    but since the method here returns a 64-bit value it is valid for billions of
    years into the past or future.
```

## ビルド系

### go build 
### ファイルやパッケージを指定しないビルド

カレントディレクトリの名前を持つ実行ファイルを生成する。

appディレクトリ内で`go build`を実行した場合、Windowsでは`app.exe`という実行ファイルが生成されれば成功


### 複数ファイルを指定するビルド
複数パッケージを含む状態に対しては依存関係のファイルを含めてビルドする。
```bash
go build main.go config.go
```
最初のパッケージ名が実行ファイル名になる。(この場合はmain.exe)


## 依存関係
### go install <パッケージ名>
- `$GOPATH`な/srcに置かれたパッケージのビルド結果が実行ファイルであれば`$GOPATH/bin`へ
- それ以外は`$GOPATH/pkg`へインストールされる

### go get <パッケージ名>
GitHubなどのサービス上で開発されているGoのパッケージなどに使用できる。

例）HTTPプロトコルの最新版、HTTP2に対応した拡張パッケージをインストールする。
```bash
go get golang.org/x/net/http2
```
何も出力されなければ成功。内部の処理を確認したい場合は`-x`を付与する。

go install同様に`$GOPATH`内に保存される。

このパッケージを利用する場合は以下のように指定する。
```go
import "golang.org/x/net/http2"
```

オプション
- -d
  - 対象パッケージのダウンロードのみ実行して停止する
- -f
  - 対象パッケージのパスから推測されるリポジトリへの検証をスキップする（-u指定時のみ）
- -fix
  - 対象パッケージの依存関係を解決する前にgo fixツールを使用する
- -insecure
  - カスタムリポジトリを使用する場合に非セキュアなプロトコルの仕様を許可する。(HTTPなど)
- -t
  - 対象パッケージに付属するテストが依存するパッケージも併せてダウンロードする
- -u
  - 対象パッケージの更新と依存パッケージの更新を検出して再ダウンロードとインストールを実施する

## go test <パッケージ名>
```bash
go test main.go
```

- 相対パスでの指定が可能
- テストを全て実施する場合は `go test ./...` と指定する。